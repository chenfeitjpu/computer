**TCP**
- [定义](#定义)
- [内容](#内容)
  - [头部格式](#头部格式)
  - [三次握手](#三次握手)
  - [四次挥手](#四次挥手)
  - [可靠性](#可靠性)
    - [重传机制](#重传机制)
  - [效率](#效率)
    - [滑动窗口](#滑动窗口)
    - [流量控制](#流量控制)
    - [拥塞控制](#拥塞控制)

# 定义 #
面向连接、可靠的、基于字节流的传输层通信协议

# 内容 #
## 头部格式 ##
  - 序列号，当前数据包编号
  - 确认应答号，下一次期望收到的序列号
  - 控制位
    - SYN 建立连接
    - ACK 确认应答
    - FIN 断开连接
    - RST 强制断开连接

## 三次握手 ##
**流程**  
1.服务端(CLOSED状态)主动监听端口(LISTEN状态)  
2.客户端(CLOSED状态)发送SYN报文(SYN_SENT状态)  
3.服务端(Listend状态)发送SYN_ACK报文(SYN_RCVD状态)  
4.客户端(SYN_SENT状态)发送ACK报文(ESTABLISHED状态)  
5.服务端(SYN_RVCD状态)收到ACK报文(ESTABLISHED状态)  
**为什么是三次**  
1.同步初始序列号
两次只能同步发送方的序列号  
2.防止重复建立连接
两次无法阻止服务端建立重复连接  

## 四次挥手 ##
**流程**  
1.客户端(ESTABLISHED状态)发送FIN报文(FIN_WAIT_1状态)  
2.服务端(ESTABLISHED状态)发送ACK报文(CLOSED_WAIT状态)  
3.客户端(FIN_WAIT_1状态)接收ACK报文(FIN_WAIT_2状态)  
4.服务端(CLOSED_WAIT状态)发送FIN报文(LAST_ACK状态)    
5.客户端(FIN_WAIT_2状态)发送ACK报文(TIME_WAIT状态)  
6.服务端(LAST_ACK状态)接收ACK报文(CLOSED状态)  
7.客户端(TIME_WAIT状态)经过2MSL(CLOSED状态)  
**为什么是四次**  
四次可以确保客户端和服务端正确关闭连接

## 可靠性 ##
### 重传机制 ###
**1.超时重传**  
原因  
 - 数据包丢失
 - 应答包丢失

**2.快速重传，三次同样的ACK**  
D-SACK

## 效率 ##
### 滑动窗口 ###
**发送方窗口**  
#1 已发送并收到ACK确认的数据  
#2 已发送但未收到ACK确认的数据(SND.UNA)  
#3 未发送但总大小在接收方处理范围内(SND.NXT)  
#4 未发送但总大小超过接收方处理范围  
**接收方窗口**
#1 已成功接收并确认的数据  
#2 未收到数据但可以接收的数据(RCV.NXT)  
#3 未收到数据并不可以接收的数据

### 流量控制 ###

### 拥塞控制 ###

