**HTTP**
- [定义](#定义)
- [内容](#内容)
  - [状态码](#状态码)
  - [常见字段](#常见字段)
  - [请求方法](#请求方法)
  - [缓存技术](#缓存技术)
  - [HTTP1.1特性](#http11特性)
  - [HTTPS](#https)
  - [HTTP2特性](#http2特性)

# 定义 #
超文本传输协议(HyperText Transfer Protocol)

# 内容 #
## 状态码 ##
- 1xx 提示信息，协议处理的中间状态，还需要后续的操作
- 2xx 成功，成功处理请求
  - 200 OK 正常
  - 204 No Content 没有body数据
  - 206 Partial Content 分段传输
- 3xx 重定向，资源位置发生变动，需要客户端重新发送请求
  - 301 Move Permanently 永久重定向 
  - 302 Found 临时重定向
  - 304 Not Modified 资源未修改
- 4xx 客户端错误，请求报文有误，服务器无法处理
  - 400 Bad Request 请求报文有误
  - 403 Forbidden 禁止访问
  - 404 Not Found 请求资源不存在
- 5xx 服务端错误，服务器在处理请求时内部发生了错误
  - 500 服务器错误 
  - 501 客户端请求的功能不支持
  - 502 服务器作为网关或代理，后端服务器发生了错误
  - 503 服务器忙，暂时无法响应
  - 504 服务器作为网关或代理，服务器超时
 
## 常见字段 ###
- Host 服务器域名
- Connection 使用持久连接
- Accept 客户端接受的数据格式
- Accept-Encoding 客户端接受的数据压缩方式
- Content-Length 服务器返回的数据长度
- Content-Type 服务器返回的数据格式
- Content-Encoding 服务器返回数据的压缩方式

## 请求方法 ##
- GET 从服务器获取资源 安全且幂等
- POST 根据请求负荷（报文body）对指定的资源做出处理 不安全且不幂等
  
## 缓存技术 ##  
**强制缓存**  
- Cache-Control 是一个相对时间
- Expires 是一个绝对时间  
Cache-Control 的优先级高于 Expires

**协商缓存**  
*基于时间*  
- 响应头部中的Last-Modified：标示这个响应资源的最后修改时间
- 请求头部中的If-Modified-Since：当资源过期了，发现响应头中具有Last-Modified声明，则再次发起请求的时候带上Last-Modified的时间  
*基于内容*
- 响应头部中Etag：唯一标识响应资源
- 请求头部中的If-None-Match：当资源过期时，浏览器发现响应头里有Etag，则再次向服务器发起请求时，会将请求头If-None-Match值设置为Etag的值  
Etag 的优先级更高  

## HTTP1.1特性 ##
**优点**  
- 简单 
- 易扩展
- 跨平台
    
**缺点**  
- 无状态
- 不安全
  - 明文传输，内容可能会被窃听
  - 不验证通信身份，可能会被冒充
  - 无法验证报文完整性，内容可能会被篡改  

**性能**  
HTTP协议是基于TCP/IP，并且使用了「请求-应答」的通信模式  
- 长连接 减少了TCP连接的重复建立和断开所造成的额外开销，减轻了服务器端的负载
- 队头阻塞

**优化**    
- 尽量避免发送HTTP请求(缓存)
- 在需要发送HTTP请求时，考虑如何减少请求次数(减少重定向、合并、延迟)
- 减少服务器的HTTP响应的数据大小(压缩)


## HTTPS ##
*特点*  
- 混合加密实现机密性，解决了窃听风险
- 摘要算法实现完整性，解决了篡改风险
- 将服务器公钥放入到数字证书，解决了冒充风险  

*SSL/TLS通信流程*  
- 客户端向服务器索要并验证公钥
- 双方协商生成会话秘钥
- 双方采用会话秘钥进行通信

*SSL/TLS握手流程*  
- 客户端发送ClientHello请求(SSL/TLS协议版本、随机数、密码套件列表)
- 服务端发送ServerHello请求(SSL/TLS协议版本、随机数、密码套件列表、数字证书、HelloDone)
- 客户端回应(随机数、加密算法改变通知、客户端握手结束通知)
- 服务的回应(加密算法改变通知、服务端握手结束通知)

*ECDHE*
通信双方通过随机私钥生成会话秘钥  

*优化*
- 硬件优化
- 软件优化
- 会话复用
- 协议优化
- 证书优化

## HTTP2特性 ##
**优化**  
- 头部压缩
- 二进制格式
- 并发传输
- 服务器推送  

**缺点**
- TCP队头阻塞


  