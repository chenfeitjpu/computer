**内存管理**
- [内容](#内容)
  - [虚拟内存](#虚拟内存)
    - [简介](#简介)
    - [内存分段](#内存分段)
    - [内存分页](#内存分页)
    - [段页式内存管理](#段页式内存管理)
    - [Linux内存布局](#linux内存布局)

# 内容 #
## 虚拟内存 ##
### 简介 ###
**为什么要有虚拟内存**  
访问控制

**实现**  
![](./images/virtual_memory.webp)

### 内存分段 ###  
**结构**  
![](./images/memorty_segment.webp)

**组成**  
- 段选择因子
- 段内偏移量

**问题**  
- 内存碎片化
- 内存交换效率低

### 内存分页 ###
**结构**
![](./images/memory_page.webp)

**组成**  
- 页号
- 页内偏移

**问题**  
- 页表占用空间大
 
**多级页表**  
*二级分页*  
![](./images/two_page_table.webp)

*四级分页*  
![](./images/four_page_table.webp)

*TLB*  
存放程序最常访问的页表项

### 段页式内存管理 ###
**结构**  
![](./images/memory_segment_page.webp)

**地址变换**
- 访问段表，得到页表起始地址
- 访问页表，得到物理页号
- 物理页号与页内位移组合，得到物理地址

### Linux内存布局 ###
**Intel处理器内存布局**  
![](./images/memory_intel.webp)

**Linux内存**  
Linux系统中的每个段都是从0地址开始的整个4GB虚拟空间（32 位环境下），也就是所有的段的起始地址都是一样的


