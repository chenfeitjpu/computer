*操作系统*
- [内容](#内容)
  - [硬件结构](#硬件结构)
  - [内存](#内存)
  - [进程\&线程](#进程线程)
  - [网络](#网络)

# 内容 #
## 硬件结构 ##
```
冯诺依曼模型
- 运算器
- 控制器
- 存储器
- 输入设备
- 输出设备

总线
- 地址总线  用于指定CPU将要操作的内存地址
- 数据总线  用于读写内存的数据
- 控制总线  用于发送和接收信号，比如中断、设备复位等信号，CPU收到信号后自然进行响应，这时也需要控制总线

CPU执行过程
- CPU读取「程序计数器」的值，将指令数据存入到「指令寄存器」
- 「程序计数器」的值自增  利用CPU的分支预测器
- CPU 分析「指令寄存器」中的指令

存储器
- 寄存器
- L1-Cahce
- L2-Cahce
- L3-Cahce
- 内存
- 硬盘

提高CPU缓存命中率
- 提升数据的缓存命中率的方式  按照内存布局顺序访问
- 如何提升指令缓存的命中率  
- 线程绑定在某一个CPU核心上
```

## 内存 ##
```
虚拟内存分配方式
- 分段
  虚拟地址：段选择因子和段内偏移量
  缺点
  - 内存碎片
  - 内存交换的效率低
- 分页
  虚拟地址：页号和页内偏移量
  缺点
  - 页表过大
  解决
  - 多级页表
  - 页表缓存
- 段页式
```

## 进程&线程 ##
```
进程
状态
- 创建状态
- 就绪状态
- 就绪挂起
- 运行状态
- 阻塞状态
- 阻塞挂起
- 结束状态
控制
- 创建进程
- 终止进程
- 阻塞进程
- 唤醒进程
上下文切换
- 用户空间资源
- 内核空间资源
- CPU资源

进程间通信 
- 管道
- 共享内存
- 信号量
- 消息队列
- SOCKET

线程
```

## 网络 ##
```
基础命令
- `ifconfig`  查看网络配置
- `netstat`  查看socket信息
- `ping`  查看连通性和延时

零拷贝
- read+write 
  四次上下文切换，四次数据拷贝
- mmap+write
  四次上下文切换，三次数据拷贝
- sendfile
  两次上下文切换，三次数据拷贝
- sendfile+SG-DMA
  两次上下文切换，两次数据拷贝

大文件传输
异步I/O+直接I/O

select&poll
select实现多路复用的方式是，将已连接的 Socket 都放到一个文件描述符集合，然后调用select函数将文件描述符集合拷贝到内核里，让内核来检查是否有网络事件产生，检查的方式很粗暴，就是通过遍历文件描述符集合的方式，当检查到有事件产生后，将此 Socket 标记为可读或可写，接着再把整个文件描述符集合拷贝回用户态里，然后用户态还需要再通过遍历的方法找到可读或可写的 Socket，然后再对其处理。
所以，对于 select 这种方式，需要进行 2 次「遍历」文件描述符集合，一次是在内核态里，一个次是在用户态里 ，而且还会发生 2 次「拷贝」文件描述符集合，先从用户空间传入内核空间，由内核修改后，再传出到用户空间中
select使用固定长度的 BitsMap，表示文件描述符集合，而且所支持的文件描述符的个数是有限制的
poll不再用BitsMap 来存储所关注的文件描述符，取而代之用动态数组，以链表形式来组织，突破了select的文件描述符个数限制

epoll
- epoll 在内核里使用红黑树来跟踪进程所有待检测的文件描述字
- epoll 使用事件驱动的机制，内核里维护了一个链表来记录就绪事件
```
